<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-10-09">

<title>Bioacoustic Data Analysis Using R 2025 - Quality checks for recordings and annotations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Bioacoustic Data Analysis Using R 2025</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./program.html"> 
<span class="menu-text">Program</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorials" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tutorials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorials">    
        <li>
    <a class="dropdown-item" href="./introduction.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./r_basics.html">
 <span class="dropdown-text">R basics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sound.html">
 <span class="dropdown-text">Sound</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./spectrograms.html">
 <span class="dropdown-text">Spectrograms</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./seewave.html">
 <span class="dropdown-text">seewave</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./annotations.html">
 <span class="dropdown-text">Annotations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./ohun.html">
 <span class="dropdown-text">ohun: automatic detection</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./intro_to_warbler.html">
 <span class="dropdown-text">Intro to warbleR</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./measure_acoustic_structure.html">
 <span class="dropdown-text">Measure acoustic structure</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./comparing_methods.html">
 <span class="dropdown-text">Comparing measuring methods</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./quality_checks.html">
 <span class="dropdown-text">Quality checks</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./measure_structure_green_hermit.html">
 <span class="dropdown-text">Measure structure on XC recordings</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-colab-notebooks" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Colab notebooks</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-colab-notebooks">    
        <li>
    <a class="dropdown-item" href="https://colab.research.google.com/drive/13Hb4sdvg6FgQi0pF1Z-Y2UrirVPpNJjb?usp=sharing">
 <span class="dropdown-text">General</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://colab.research.google.com/github/maRce10/dynaSpec/blob/master/dynaSpec.ipynb">
 <span class="dropdown-text">dynaSpec</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://colab.research.google.com/drive/115nmxxe1pdSqshTW2ABlBNddhVPpCV6F?usp=sharing">
 <span class="dropdown-text">ohun</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./course_prep.html"> 
<span class="menu-text">Course prep</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://codefile.io/f/it6V84xpHM"> 
<span class="menu-text">Code sharing</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./instructor.html"> 
<span class="menu-text">Instructor</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/maRce10/PRSTATS_BR_2025/"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul class="collapse">
  <li><a href="#organize-acoustic-data" id="toc-organize-acoustic-data" class="nav-link active" data-scroll-target="#organize-acoustic-data"><span class="header-section-number">1</span> Organize acoustic data</a>
  <ul class="collapse">
  <li><a href="#consolidate-files" id="toc-consolidate-files" class="nav-link" data-scroll-target="#consolidate-files"><span class="header-section-number">1.1</span> Consolidate files</a></li>
  </ul></li>
  <li><a href="#homogenize-recording-format" id="toc-homogenize-recording-format" class="nav-link" data-scroll-target="#homogenize-recording-format"><span class="header-section-number">2</span> Homogenize recording format</a>
  <ul class="collapse">
  <li><a href="#convert-.mp3-to-.wav" id="toc-convert-.mp3-to-.wav" class="nav-link" data-scroll-target="#convert-.mp3-to-.wav"><span class="header-section-number">2.1</span> Convert .mp3 to .wav</a></li>
  <li><a href="#homogenize-.wav-files" id="toc-homogenize-.wav-files" class="nav-link" data-scroll-target="#homogenize-.wav-files"><span class="header-section-number">2.2</span> Homogenize .wav files</a></li>
  <li><a href="#homogenize-extended-selection-tables" id="toc-homogenize-extended-selection-tables" class="nav-link" data-scroll-target="#homogenize-extended-selection-tables"><span class="header-section-number">2.3</span> Homogenize extended selection tables</a></li>
  </ul></li>
  <li><a href="#check-recordings" id="toc-check-recordings" class="nav-link" data-scroll-target="#check-recordings"><span class="header-section-number">3</span> Check recordings</a></li>
  <li><a href="#optimizing-spectrograms" id="toc-optimizing-spectrograms" class="nav-link" data-scroll-target="#optimizing-spectrograms"><span class="header-section-number">4</span> Optimizing spectrograms</a></li>
  <li><a href="#double-check-selections" id="toc-double-check-selections" class="nav-link" data-scroll-target="#double-check-selections"><span class="header-section-number">5</span> Double-check selections</a>
  <ul class="collapse">
  <li><a href="#catalogs" id="toc-catalogs" class="nav-link" data-scroll-target="#catalogs"><span class="header-section-number">5.1</span> Catalogs</a></li>
  <li><a href="#tailoring-selections" id="toc-tailoring-selections" class="nav-link" data-scroll-target="#tailoring-selections"><span class="header-section-number">5.2</span> Tailoring selections</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">5.3</span> References</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><font size="7"><b>Quality checks for recordings and annotations</b></font></h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 9, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>&nbsp;</p>
<section id="objetive" class="level2 unnumbered unlisted alert alert-info">
<h2 class="unnumbered unlisted anchored" data-anchor-id="objetive"><strong>Objetive</strong></h2>
<ul>
<li>Provide tools for double-checking the quality of the acoustic data and measures</li>
</ul>
</section>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>When working with sound files obtained from various sources it is common to have variation in recording formats and parameters or even find corrupt files. Similarly, when a large number of annotations are used, it is normal to find errors in some of them. These problems may prevent the use of acoustic analysis in <strong>warbleR</strong>. Luckily, the package also offers functions to facilitate the detection and correction of errors in sound files and annotations.</p>
<section id="organize-acoustic-data" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Organize acoustic data</h1>
<section id="consolidate-files" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="consolidate-files"><span class="header-section-number">1.1</span> Consolidate files</h2>
<p>The <code>consolidate()</code> function allows you to copy all the sound files in a specified format (e.g.&nbsp;‘.wav’) from subdirectories into a single directory. This is useful when you have sound files in different folders and want to analyze them together using <code>warbleR</code>. The function creates a new folder called ‘consolidated_files’ in the working directory and copies all the files with the specified extension into it. Let’s see how it works with the example files in the ‘./examples’ folder:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load warbleR</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(warbleR)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># consolidate .wav files</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>consolidated_files <span class="ot">&lt;-</span> <span class="fu">consolidate</span>(<span class="at">file.ext =</span> <span class="st">".wav"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print output data frame</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(consolidated_files)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 63%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">original_dir</th>
<th style="text-align: left;">old_name</th>
<th style="text-align: left;">new_name</th>
<th style="text-align: right;">file_size_bytes</th>
<th style="text-align: left;">duplicate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">/home/marce/Dropbox/courses_and_workshops/Bioacoustics/PRSTATS_BR_2025/examples/inquiry</td>
<td style="text-align: left;">1_ch1-1.wav</td>
<td style="text-align: left;">1_ch1-1.wav</td>
<td style="text-align: right;">8530218</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">/home/marce/Dropbox/courses_and_workshops/Bioacoustics/PRSTATS_BR_2025/examples/inquiry</td>
<td style="text-align: left;">1_ch1.wav</td>
<td style="text-align: left;">1_ch1.wav</td>
<td style="text-align: right;">8800218</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">/home/marce/Dropbox/courses_and_workshops/Bioacoustics/PRSTATS_BR_2025/examples/inquiry</td>
<td style="text-align: left;">1_ch2-1.wav</td>
<td style="text-align: left;">1_ch2-1.wav</td>
<td style="text-align: right;">8530218</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">/home/marce/Dropbox/courses_and_workshops/Bioacoustics/PRSTATS_BR_2025/examples/inquiry</td>
<td style="text-align: left;">1_ch2.wav</td>
<td style="text-align: left;">1_ch2.wav</td>
<td style="text-align: right;">8800218</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">/home/marce/Dropbox/courses_and_workshops/Bioacoustics/PRSTATS_BR_2025/examples/inquiry</td>
<td style="text-align: left;">1_ch3-1.wav</td>
<td style="text-align: left;">1_ch3-1.wav</td>
<td style="text-align: right;">8530218</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">/home/marce/Dropbox/courses_and_workshops/Bioacoustics/PRSTATS_BR_2025/examples/inquiry</td>
<td style="text-align: left;">1_ch3.wav</td>
<td style="text-align: left;">1_ch3.wav</td>
<td style="text-align: right;">8800218</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The output is a data frame with the original paths and the original and new file names. Note that if there are files with the same name in different folders, the function adds a number to the end of the file name to avoid overwriting. It also labels possible duplicates in the output data frame.</p>
</section>
</section>
<section id="homogenize-recording-format" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Homogenize recording format</h1>
<section id="convert-.mp3-to-.wav" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="convert-.mp3-to-.wav"><span class="header-section-number">2.1</span> Convert .mp3 to .wav</h2>
<p>The <code>mp32wav()</code> function allows you to convert files in ‘.mp3’ format to ‘.wav’ format. This function converts all the ‘mp3’ files in the working directory. Let’s use the files in the ‘./examples/mp3’ folder as an example. This are the ‘mp3’ files in that folder:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"./examples/mp3"</span>, <span class="at">pattern =</span> <span class="st">"mp3$"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "BlackCappedVireo.mp3" "BowheadWhaleSong.mp3" "CanyonWren.mp3"      </code></pre>
</div>
</div>
<p>We can convert them to ‘.wav’ format like this:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mp32wav</span>(<span class="at">path =</span> <span class="st">"./examples/mp3"</span>, <span class="at">dest.path =</span> <span class="st">"./examples/mp3"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"./examples/mp3"</span>, <span class="at">pattern =</span> <span class="st">"mp3$|wav$"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "BlackCappedVireo.mp3" "BlackCappedVireo.wav" "BowheadWhaleSong.mp3"
[4] "BowheadWhaleSong.wav" "CanyonWren.mp3"       "CanyonWren.wav"      </code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>We can also modify the sampling rate and/or dynamic range with <code>mp32wav()</code>:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mp32wav</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"./examples/mp3"</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">samp.rate =</span> <span class="dv">48</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">bit.depth =</span> <span class="dv">24</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">overwrite =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">dest.path =</span> <span class="st">"./examples/mp3"</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"./examples/mp3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp;</p>
<p>We can check the properties of the sound files using the <code>info_sound_files()</code> function:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">info_sound_files</span>(<span class="at">path =</span> <span class="st">"./examples/mp3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">sound.files</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">duration</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">sample.rate</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">channels</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">bits</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">wav.size</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">samples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">BlackCappedVireo.mp3</td>
<td style="text-align: center;">5.459592</td>
<td style="text-align: center;">22.05</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">0.087770</td>
<td style="text-align: center;">120384</td>
</tr>
<tr class="even">
<td style="text-align: center;">BlackCappedVireo.wav</td>
<td style="text-align: center;">5.459592</td>
<td style="text-align: center;">22.05</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">0.240812</td>
<td style="text-align: center;">120384</td>
</tr>
<tr class="odd">
<td style="text-align: center;">BowheadWhaleSong.mp3</td>
<td style="text-align: center;">86.648163</td>
<td style="text-align: center;">22.05</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">1.386787</td>
<td style="text-align: center;">1910592</td>
</tr>
<tr class="even">
<td style="text-align: center;">BowheadWhaleSong.wav</td>
<td style="text-align: center;">86.648163</td>
<td style="text-align: center;">22.05</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">3.821228</td>
<td style="text-align: center;">1910592</td>
</tr>
<tr class="odd">
<td style="text-align: center;">CanyonWren.mp3</td>
<td style="text-align: center;">5.433469</td>
<td style="text-align: center;">44.10</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">0.087352</td>
<td style="text-align: center;">239616</td>
</tr>
<tr class="even">
<td style="text-align: center;">CanyonWren.wav</td>
<td style="text-align: center;">5.433469</td>
<td style="text-align: center;">44.10</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">0.479276</td>
<td style="text-align: center;">239616</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="homogenize-.wav-files" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="homogenize-.wav-files"><span class="header-section-number">2.2</span> Homogenize .wav files</h2>
<p>Alternatively, we can use the <code>fix_wavs()</code> function to homogenize the sampling rate, the dynamic interval and the number of channels. It is adviced that all sound files should have the same recording format settings before any acoustic analysis. In the example ‘.mp3’ files, not all of them have been recorded with the same settings:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">info_sound_files</span>(<span class="at">path =</span> <span class="st">"./examples/mp3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">sound.files</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">duration</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">sample.rate</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">channels</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">bits</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">wav.size</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">samples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">BlackCappedVireo.mp3</td>
<td style="text-align: center;">5.459592</td>
<td style="text-align: center; background-color: rgba(204, 235, 255, 255) !important;">22.05</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">0.087770</td>
<td style="text-align: center;">120384</td>
</tr>
<tr class="even">
<td style="text-align: center;">BlackCappedVireo.wav</td>
<td style="text-align: center;">5.459592</td>
<td style="text-align: center; background-color: rgba(204, 235, 255, 255) !important;">22.05</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">0.240812</td>
<td style="text-align: center;">120384</td>
</tr>
<tr class="odd">
<td style="text-align: center;">BowheadWhaleSong.mp3</td>
<td style="text-align: center;">86.648163</td>
<td style="text-align: center; background-color: rgba(204, 235, 255, 255) !important;">22.05</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">1.386787</td>
<td style="text-align: center;">1910592</td>
</tr>
<tr class="even">
<td style="text-align: center;">BowheadWhaleSong.wav</td>
<td style="text-align: center;">86.648163</td>
<td style="text-align: center; background-color: rgba(204, 235, 255, 255) !important;">22.05</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">3.821228</td>
<td style="text-align: center;">1910592</td>
</tr>
<tr class="odd">
<td style="text-align: center;">CanyonWren.mp3</td>
<td style="text-align: center;">5.433469</td>
<td style="text-align: center; background-color: rgba(204, 235, 255, 255) !important;">44.10</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">0.087352</td>
<td style="text-align: center;">239616</td>
</tr>
<tr class="even">
<td style="text-align: center;">CanyonWren.wav</td>
<td style="text-align: center;">5.433469</td>
<td style="text-align: center; background-color: rgba(204, 235, 255, 255) !important;">44.10</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">0.479276</td>
<td style="text-align: center;">239616</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>&nbsp;</p>
<p>The <code>fix_wavs()</code> function will convert all files to the same sampling rate and dynamic range:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fix_wavs</span>(<span class="at">path =</span> <span class="st">"./examples/mp3"</span>,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">samp.rate =</span> <span class="fl">44.1</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">bit.depth =</span> <span class="dv">24</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">info_sound_files</span>(<span class="at">path =</span> <span class="st">"./examples/mp3/converted_sound_files"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">sound.files</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">duration</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">sample.rate</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">channels</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">bits</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">wav.size</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">samples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">BlackCappedVireo.wav</td>
<td style="text-align: center;">5.459592</td>
<td style="text-align: center; background-color: rgba(204, 235, 255, 255) !important;">44.1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center; background-color: rgba(204, 235, 255, 255) !important;">24</td>
<td style="text-align: center;">0.722348</td>
<td style="text-align: center;">240768</td>
</tr>
<tr class="even">
<td style="text-align: center;">BowheadWhaleSong.wav</td>
<td style="text-align: center;">86.648163</td>
<td style="text-align: center; background-color: rgba(204, 235, 255, 255) !important;">44.1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center; background-color: rgba(204, 235, 255, 255) !important;">24</td>
<td style="text-align: center;">11.463596</td>
<td style="text-align: center;">3821184</td>
</tr>
<tr class="odd">
<td style="text-align: center;">CanyonWren.wav</td>
<td style="text-align: center;">5.433469</td>
<td style="text-align: center; background-color: rgba(204, 235, 255, 255) !important;">44.1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center; background-color: rgba(204, 235, 255, 255) !important;">24</td>
<td style="text-align: center;">0.718892</td>
<td style="text-align: center;">239616</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Another useful function to check file properties is <code>duration_sound_files()</code>. This function returns the duration in seconds of each ‘.wav’ file.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">duration_sound_files</span>(<span class="at">path =</span> <span class="st">"./examples/mp3/converted_sound_files/"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">sound.files</th>
<th style="text-align: right;">duration</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">BlackCappedVireo.wav</td>
<td style="text-align: right;">5.459592</td>
</tr>
<tr class="even">
<td style="text-align: left;">BowheadWhaleSong.wav</td>
<td style="text-align: right;">86.648163</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CanyonWren.wav</td>
<td style="text-align: right;">5.433469</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="homogenize-extended-selection-tables" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="homogenize-extended-selection-tables"><span class="header-section-number">2.3</span> Homogenize extended selection tables</h2>
<p>The <code>resample_est</code>()` function allows you to homogenize sampling rate and dynamic range of an extended selection table. This is useful when the selection table contains selections from recordings with different sampling rates or dynamic ranges. Let’s see how it works with the example ‘lbh.ext’ selection table. First check the sampling rates and bit depths of the acoustic data in the selection table:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"lbh.est"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># check sampling rates and bit depths</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(<span class="fu">attributes</span>(lbh.est)<span class="sc">$</span>check.res<span class="sc">$</span>sample.rate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22.05</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(<span class="fu">attributes</span>(lbh.est)<span class="sc">$</span>check.res<span class="sc">$</span>bits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "8"</code></pre>
</div>
</div>
<p>Now let’s resample the recordings to a sampling rate of 11.025 kHz and a bit depth of 24:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>lbh.est_resamp <span class="ot">&lt;-</span> <span class="fu">resample_est</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> lbh.est,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">samp.rate =</span> <span class="fl">11.025</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">bit.depth =</span> <span class="dv">24</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># check sampling rates and bit depths again</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(<span class="fu">attributes</span>(lbh.est_resamp)<span class="sc">$</span>check.res<span class="sc">$</span>sample.rate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.025</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(<span class="fu">attributes</span>(lbh.est_resamp)<span class="sc">$</span>check.res<span class="sc">$</span>bits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "24"</code></pre>
</div>
</div>
</section>
</section>
<section id="check-recordings" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Check recordings</h1>
<p><code>check_sound_files()</code> should be the first function that should be used before running any <strong>warbleR</strong> analysis. The function simply checks if the sound files in ‘.wav’ format in the working directory can be read in R. For example, the following code checks all the files in the ‘examples’ folder, which should detect the ‘corrupted_file.wav’:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_sound_files</span>(<span class="at">path =</span> <span class="st">"./examples"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>All files can be read</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Not all sound files have the same sampling rate (potentially problematic, particularly for cross_correlation())</code></pre>
</div>
</div>
<p>Let’s see how it works when we simulate a corrupted file:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save text file as wave file</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="st">"This is not a wave file"</span>, <span class="at">con =</span> <span class="st">"./examples/corrupted_file.wav"</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># check again</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>checks <span class="ot">&lt;-</span> <span class="fu">check_sound_files</span>(<span class="at">path =</span> <span class="st">"./examples"</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>checks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">sound.files</th>
<th style="text-align: right;">samp.rate</th>
<th style="text-align: left;">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">bit24.wav</td>
<td style="text-align: right;">44100</td>
<td style="text-align: left;">can be read</td>
</tr>
<tr class="even">
<td style="text-align: left;">bit64.wav</td>
<td style="text-align: right;">44100</td>
<td style="text-align: left;">can be read</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bit8.wav</td>
<td style="text-align: right;">44100</td>
<td style="text-align: left;">can be read</td>
</tr>
<tr class="even">
<td style="text-align: left;">corrupted_file.wav</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">cannot be read</td>
</tr>
<tr class="odd">
<td style="text-align: left;">downsmp.wav</td>
<td style="text-align: right;">11250</td>
<td style="text-align: left;">can be read</td>
</tr>
<tr class="even">
<td style="text-align: left;">LBH.374.SUR.wav</td>
<td style="text-align: right;">44100</td>
<td style="text-align: left;">can be read</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Phae.long1.flac</td>
<td style="text-align: right;">22050</td>
<td style="text-align: left;">can be read</td>
</tr>
<tr class="even">
<td style="text-align: left;">Phae.long1.mp3</td>
<td style="text-align: right;">22050</td>
<td style="text-align: left;">can be read</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Phae.long1.wav</td>
<td style="text-align: right;">22500</td>
<td style="text-align: left;">can be read</td>
</tr>
<tr class="even">
<td style="text-align: left;">Phae.long2.wav</td>
<td style="text-align: right;">22500</td>
<td style="text-align: left;">can be read</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Phae.long3.wav</td>
<td style="text-align: right;">22500</td>
<td style="text-align: left;">can be read</td>
</tr>
<tr class="even">
<td style="text-align: left;">Phae.long4.wav</td>
<td style="text-align: right;">22500</td>
<td style="text-align: left;">can be read</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Phaethornis-eurynome-15607.wav</td>
<td style="text-align: right;">44100</td>
<td style="text-align: left;">can be read</td>
</tr>
<tr class="even">
<td style="text-align: left;">Phaethornis-squalidus-555876.mp3</td>
<td style="text-align: right;">48000</td>
<td style="text-align: left;">can be read</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Phaethornis-striigularis-154074.mp3</td>
<td style="text-align: right;">44100</td>
<td style="text-align: left;">can be read</td>
</tr>
<tr class="even">
<td style="text-align: left;">Phaethornis-striigularis-518510.mp3</td>
<td style="text-align: right;">48000</td>
<td style="text-align: left;">can be read</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Phaethornis-striigularis-537364.mp3</td>
<td style="text-align: right;">44100</td>
<td style="text-align: left;">can be read</td>
</tr>
<tr class="even">
<td style="text-align: left;">recording_20170716_230503.wac</td>
<td style="text-align: right;">384000</td>
<td style="text-align: left;">can be read</td>
</tr>
<tr class="odd">
<td style="text-align: left;">song.dynrang.wav</td>
<td style="text-align: right;">44100</td>
<td style="text-align: left;">can be read</td>
</tr>
<tr class="even">
<td style="text-align: left;">song.dynrang24.wav</td>
<td style="text-align: right;">44100</td>
<td style="text-align: left;">can be read</td>
</tr>
<tr class="odd">
<td style="text-align: left;">test.wav</td>
<td style="text-align: right;">11025</td>
<td style="text-align: left;">can be read</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>&nbsp;</p>
</section>
<section id="optimizing-spectrograms" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Optimizing spectrograms</h1>
<p>The parameters that determine the appearance of spectrograms (and power spectra and periodgrams) also have an effect on the measurements taken on them. Therefore it is necessary to use the same parameters to analyze all the signals in a project (except with some exceptions) so that the measurements are comparable. The visualization of spectrograms generated with different spectrographic parameters is a useful way of defining the combination of parameters with which the structure of the signals is distinguished in more detail. The function <code>tweak_spectro()</code> aims to simplify the selection of parameters through the display of spectrograms. The function plots, for a single selection, a mosaic of spectrograms with different display parameters. For numerical arguments, the upper and lower limits of a range can be provided. The following parameters may have variable values:</p>
<ul>
<li><strong>wl</strong>: window length (numerical range)</li>
<li><strong>ovlp</strong>: overlap (numerical range)</li>
<li><strong>collev.min</strong>: minimum amplitude value for color levels (numerical range)</li>
<li><strong>wn</strong>: window function name (character)</li>
<li><strong>pal</strong>: palette (character)</li>
</ul>
<p>The following code generates an image with spectrograms that vary in window size and window function (the rest of the parameters are passed to the <code>catalog ()</code> function internally to create the mosaic):</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tweak_spectro</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> lbh_selec_table,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">wl =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">1000</span>),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">wn =</span> <span class="fu">c</span>(<span class="st">"hanning"</span>, <span class="st">"hamming"</span>, <span class="st">"rectangle"</span>),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">length.out =</span> <span class="dv">16</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">8</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">6</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">15</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">20</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">rm.axes =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="dv">1</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">box =</span> F</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="images/spec_param1.jpeg" alt="viewSpec" width="100%"></p>
<p>&nbsp;</p>
<p>Note that the <code>length.out</code> argument defines the number of values to interpolate within the numerical ranges. <code>wl = 220</code> seems to produce clearer spectrograms.</p>
<p>We can add a color palette to differentiate the levels of one of the parameters, for example ‘wn’:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("RColorBrewer")</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create palette</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>cmc <span class="ot">&lt;-</span> <span class="cf">function</span>(n)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n <span class="sc">&gt;</span> <span class="dv">5</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="fu">adjustcolor</span>(<span class="fu">brewer.pal</span>(<span class="dv">5</span>, <span class="st">"Spectral"</span>), </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">alpha.f =</span> <span class="fl">0.6</span>), <span class="fu">ceiling</span>(n <span class="sc">/</span><span class="dv">4</span>))[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjustcolor</span>(<span class="fu">brewer.pal</span>(n, <span class="st">"Spectral"</span>), <span class="at">alpha.f =</span> <span class="fl">0.6</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tweak_spectro</span>(</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> lbh_selec_table,</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">wl =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">1000</span>),</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">wn =</span> <span class="fu">c</span>(<span class="st">"hanning"</span>, <span class="st">"hamming"</span>, <span class="st">"rectangle"</span>),</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">length.out =</span> <span class="dv">16</span>,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">8</span>,</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">6</span>,</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">15</span>,</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">20</span>,</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">rm.axes =</span> <span class="cn">TRUE</span>,</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="dv">1</span>,</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">box =</span> F,</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.tag =</span> <span class="st">"wn"</span>,</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">tag.pal =</span> <span class="fu">list</span>(cmc)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="images/spec_param3.jpeg" alt="viewSpec" width="100%"></p>
<p>&nbsp;</p>
<p>We can also use it to choose the color palette and the minimum amplitude for plotting (‘collev.min’):</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tweak_spectro</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> lbh_selec_table,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">wl =</span> <span class="dv">220</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">collev.min =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="sc">-</span><span class="dv">100</span>),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">pal =</span> <span class="fu">c</span>(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"reverse.gray.colors.2"</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"reverse.topo.colors"</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"reverse.terrain.colors"</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">length.out =</span> <span class="dv">16</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">8</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">6</span>,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">15</span>,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">20</span>,</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">rm.axes =</span> <span class="cn">TRUE</span>,</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="dv">1</span>,</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">box =</span> F,</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.tag =</span> <span class="st">"pal"</span>,</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">tag.pal =</span> <span class="fu">list</span>(cmc)</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="images/spec_param2.jpeg" alt="viewSpec" width="100%"></p>
<div class="alert alert-info">
<p><font size="5">Exercise</font></p>
<p>The file <code>iniquiry_calls.RDS</code> (in <code>./examples</code>) contains an extended selection table of inquiry calls of Spix’s disc-winged bats (<em>Thyroptera tricolor</em>). This is a Neotropical species that uses a specific call type to locate social mates in their roosts. We can read this file like this:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>inq <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">"./examples/iniquiry_calls.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><p>Using the ‘inq’ data, find the best window length (‘wl’) to visualize the inquiry calls using <code>tweak_spectro()</code> (keep in mind this are ultrasonic signals)</p></li>
<li><p>Try 3 color palettes from the package ‘viridis’ to visualize the spectrograms (you will need to install and load the package) while also testing different <code>collev.min</code> values.</p></li>
</ul>
</div>
</section>
<section id="double-check-selections" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Double-check selections</h1>
<p>The main function to double-check selection tables is <code>check_sels()</code>. This function checks a large number of possible errors in the selection information:</p>
<ul>
<li>‘X’ is an object of the class ‘data.frame’ or ‘selection_table’ (see selection_table) and contains the columns required to be used in any warbleR function (‘sound.files’, ‘selec’, ‘start’ , ‘end’, if it does not return an error)</li>
<li>‘sound.files’ in ‘X’ corresponds to the .wav files in the working directory or in the provided ‘path’ (if no file is found it returns an error, if some files are not found it returns error information in the output data frame)</li>
<li>the time (‘start’, ‘end’) and frequency limits (‘bottom.freq’, ‘top.freq’, if provided) are numeric and do not contain NA (if they do not return an error)</li>
<li>There are no duplicate selection tags (‘selec’) within a sound file (if it does not return an error)</li>
<li>The start and end time of the selections is within the duration of the sound files (error information in the output data frame)</li>
<li>Sound files can be read (error information in the output data frame)</li>
<li>The header of the sound files is not damaged (only if the header = TRUE, error information in the selection table with results)</li>
<li>‘top.freq’ is less than half of the sampling frequency (nyquist frequency, error information in the data table with results)</li>
<li>Negative values are not found in the time or frequency limits (error information in the data table with results)</li>
<li>‘start’ higher than ‘end’ or ‘bottom.freq’ higher than ‘top.freq’ (error information in the output data frame)</li>
<li>The value of ‘channel’ is not greater than the number of channels in the sound files (error information in the output data frame)</li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>cs <span class="ot">&lt;-</span> <span class="fu">check_sels</span>(lbh_selec_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp;</p>
<p>The function returns a data frame that includes the information in ‘X’ plus additional columns about the format of the sound files, as well as the result of the checks (column ‘check.res’):</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>cs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">sound.files</th>
<th style="text-align: right;">channel</th>
<th style="text-align: right;">selec</th>
<th style="text-align: right;">start</th>
<th style="text-align: right;">end</th>
<th style="text-align: right;">bottom.freq</th>
<th style="text-align: right;">top.freq</th>
<th style="text-align: left;">check.res</th>
<th style="text-align: right;">duration</th>
<th style="text-align: right;">min.n.samples</th>
<th style="text-align: right;">sample.rate</th>
<th style="text-align: right;">channels</th>
<th style="text-align: right;">bits</th>
<th style="text-align: right;">sound.file.samples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Phae.long1.wav</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.1693549</td>
<td style="text-align: right;">1.3423884</td>
<td style="text-align: right;">2.220105</td>
<td style="text-align: right;">8.604378</td>
<td style="text-align: left;">OK</td>
<td style="text-align: right;">0.1730334</td>
<td style="text-align: right;">3893</td>
<td style="text-align: right;">22.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">56251</td>
</tr>
<tr class="even">
<td style="text-align: left;">Phae.long1.wav</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.1584085</td>
<td style="text-align: right;">2.3214565</td>
<td style="text-align: right;">2.169437</td>
<td style="text-align: right;">8.807053</td>
<td style="text-align: left;">OK</td>
<td style="text-align: right;">0.1630480</td>
<td style="text-align: right;">3668</td>
<td style="text-align: right;">22.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">56251</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Phae.long1.wav</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.3433366</td>
<td style="text-align: right;">0.5182553</td>
<td style="text-align: right;">2.218294</td>
<td style="text-align: right;">8.756604</td>
<td style="text-align: left;">OK</td>
<td style="text-align: right;">0.1749187</td>
<td style="text-align: right;">3935</td>
<td style="text-align: right;">22.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">56251</td>
</tr>
<tr class="even">
<td style="text-align: left;">Phae.long2.wav</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.1595983</td>
<td style="text-align: right;">0.2921692</td>
<td style="text-align: right;">2.316862</td>
<td style="text-align: right;">8.822316</td>
<td style="text-align: left;">OK</td>
<td style="text-align: right;">0.1325709</td>
<td style="text-align: right;">2982</td>
<td style="text-align: right;">22.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">38251</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Phae.long2.wav</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.4570585</td>
<td style="text-align: right;">1.5832087</td>
<td style="text-align: right;">2.284006</td>
<td style="text-align: right;">8.888027</td>
<td style="text-align: left;">OK</td>
<td style="text-align: right;">0.1261502</td>
<td style="text-align: right;">2838</td>
<td style="text-align: right;">22.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">38251</td>
</tr>
<tr class="even">
<td style="text-align: left;">Phae.long3.wav</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.6265520</td>
<td style="text-align: right;">0.7577715</td>
<td style="text-align: right;">3.006834</td>
<td style="text-align: right;">8.822316</td>
<td style="text-align: left;">OK</td>
<td style="text-align: right;">0.1312195</td>
<td style="text-align: right;">2952</td>
<td style="text-align: right;">22.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">49500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Phae.long3.wav</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.9742132</td>
<td style="text-align: right;">2.1043921</td>
<td style="text-align: right;">2.776843</td>
<td style="text-align: right;">8.888027</td>
<td style="text-align: left;">OK</td>
<td style="text-align: right;">0.1301789</td>
<td style="text-align: right;">2929</td>
<td style="text-align: right;">22.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">49500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Phae.long3.wav</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.1233643</td>
<td style="text-align: right;">0.2545812</td>
<td style="text-align: right;">2.316862</td>
<td style="text-align: right;">9.315153</td>
<td style="text-align: left;">OK</td>
<td style="text-align: right;">0.1312170</td>
<td style="text-align: right;">2952</td>
<td style="text-align: right;">22.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">49500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Phae.long4.wav</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.5168116</td>
<td style="text-align: right;">1.6622365</td>
<td style="text-align: right;">2.513997</td>
<td style="text-align: right;">9.216586</td>
<td style="text-align: left;">OK</td>
<td style="text-align: right;">0.1454249</td>
<td style="text-align: right;">3272</td>
<td style="text-align: right;">22.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">72000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Phae.long4.wav</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.9326920</td>
<td style="text-align: right;">3.0768784</td>
<td style="text-align: right;">2.579708</td>
<td style="text-align: right;">10.235116</td>
<td style="text-align: left;">OK</td>
<td style="text-align: right;">0.1441864</td>
<td style="text-align: right;">3244</td>
<td style="text-align: right;">22.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">72000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Phae.long4.wav</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.1453977</td>
<td style="text-align: right;">0.2904966</td>
<td style="text-align: right;">2.579708</td>
<td style="text-align: right;">9.742279</td>
<td style="text-align: left;">OK</td>
<td style="text-align: right;">0.1450989</td>
<td style="text-align: right;">3264</td>
<td style="text-align: right;">22.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">72000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Let’s modified a selection table to see how the function works:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># copiar las primeras 6 filas</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>st2 <span class="ot">&lt;-</span> lbh_selec_table[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, ]</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># hacer caracter </span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>st2<span class="sc">$</span>sound.files <span class="ot">&lt;-</span> <span class="fu">as.character</span>(st2<span class="sc">$</span>sound.files)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># cambiar nombre de archivo de sonido en sel 1</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>st2<span class="sc">$</span>sound.files[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"aaa.wav"</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># modificar fin en sel 3</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>st2<span class="sc">$</span>end[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co"># hacer top.freq igual q bottom freq en sel 3</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>st2<span class="sc">$</span>top.freq[<span class="dv">3</span>] <span class="ot">&lt;-</span> st2<span class="sc">$</span>bottom.freq[<span class="dv">3</span>]</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co"># modificar top freq en sel 5</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>st2<span class="sc">$</span>top.freq[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="co"># modificar channes en sel 6</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>st2<span class="sc">$</span>channel[<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="co">#revisar</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>cs <span class="ot">&lt;-</span> <span class="fu">check_sels</span>(st2)</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>cs[, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">10</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">sound.files</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">channel</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">selec</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">start</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">end</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">bottom.freq</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">top.freq</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">min.n.samples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">aaa.wav</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1.1693549</td>
<td style="text-align: center;">1.3423884</td>
<td style="text-align: center;">2.220105</td>
<td style="text-align: center;">8.604378</td>
<td style="text-align: center; background-color: rgba(204, 235, 255, 255) !important;">NA</td>
</tr>
<tr class="even">
<td style="text-align: center;">Phae.long1.wav</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2.1584085</td>
<td style="text-align: center;">2.3214565</td>
<td style="text-align: center;">2.169437</td>
<td style="text-align: center;">8.807053</td>
<td style="text-align: center; background-color: rgba(204, 235, 255, 255) !important;">3668</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Phae.long1.wav</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">0.3433366</td>
<td style="text-align: center;">100.0000000</td>
<td style="text-align: center;">2.218294</td>
<td style="text-align: center;">2.218294</td>
<td style="text-align: center; background-color: rgba(204, 235, 255, 255) !important;">2242274</td>
</tr>
<tr class="even">
<td style="text-align: center;">Phae.long2.wav</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.1595983</td>
<td style="text-align: center;">0.2921692</td>
<td style="text-align: center;">2.316862</td>
<td style="text-align: center;">8.822316</td>
<td style="text-align: center; background-color: rgba(204, 235, 255, 255) !important;">2982</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Phae.long2.wav</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1.4570585</td>
<td style="text-align: center;">1.5832087</td>
<td style="text-align: center;">2.284006</td>
<td style="text-align: center;">200.000000</td>
<td style="text-align: center; background-color: rgba(204, 235, 255, 255) !important;">2838</td>
</tr>
<tr class="even">
<td style="text-align: center;">Phae.long3.wav</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.6265520</td>
<td style="text-align: center;">0.7577715</td>
<td style="text-align: center;">3.006834</td>
<td style="text-align: center;">8.822316</td>
<td style="text-align: center; background-color: rgba(204, 235, 255, 255) !important;">2952</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>&nbsp;</p>
<p><code>check_sels()</code> is used internally when creating selection tables and extended selection tables.</p>
<p>&nbsp;</p>
<section id="visual-inspection-of-spectrograms" class="level3" data-number="5.0.1">
<h3 data-number="5.0.1" class="anchored" data-anchor-id="visual-inspection-of-spectrograms"><span class="header-section-number">5.0.1</span> Visual inspection of spectrograms</h3>
<p>Once the information in the selections has been verified, the next step is to ensure that the selections contain accurate information about the location of the signals of interest. This can be done by creating spectrograms of all selections. For this we have several options. The first is <code>spectrograms()</code> (previously called <code>specreator()</code>) which generates (by default) a spectrogram for each selection. We can run it on the sample data like this:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using default parameters tweak_spectro()</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">warbleR_options</span>(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">wav.path =</span> <span class="st">"./examples"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">wl =</span> <span class="dv">220</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">wn =</span> <span class="st">"hanning"</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ovlp =</span> <span class="dv">90</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pal =</span> reverse.topo.colors</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="fu">spectrograms</span>(lbh_selec_table, <span class="at">collevels =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The images it produces are saved in the working directory and look like this:</p>
<p><img src="images/spectrograms2.gif" alt="viewSpec" width="50%"></p>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Exercise</font></p>
<p>&nbsp;</p>
<ul>
<li>Have the label shown on the selection display the data in the ‘sel.comment’ column of the sample selection box using the <code>sel.labels</code> argument</li>
</ul>
</div>
<p>&nbsp;</p>
</section>
<section id="full-spectrograms" class="level3" data-number="5.0.2">
<h3 data-number="5.0.2" class="anchored" data-anchor-id="full-spectrograms"><span class="header-section-number">5.0.2</span> Full spectrograms</h3>
<p>We can create spectrograms for the whole sound files using <code>full_spectrograms()</code>. If the <code>X</code> argument is not given, the function will create the spectrograms for all the files in the working directory. Otherwise, the function generates spectrograms for sound files in <code>X</code> and highlights selections with transparent rectangles similar to those of<code>spectrograms()</code>. In this example we download a recording from a striped-throated hermit (<em>Phaethornis striigularis</em>) from Xeno-Canto:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load package with color palettes</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create directory</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">"./examples/hermit"</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># download sound file</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>phae.stri <span class="ot">&lt;-</span> <span class="fu">query_xc</span>(<span class="at">qword =</span> <span class="st">"nr:154074"</span>,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">download =</span> <span class="cn">TRUE</span>,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">path =</span> <span class="st">"./examples/hermit"</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert mp3 to wav format</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="fu">mp32wav</span>(<span class="at">path =</span> <span class="st">"./examples/hermit/"</span>, <span class="at">pb =</span> <span class="cn">FALSE</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co"># plot full spec</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="fu">full_spectrograms</span>(</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sxrow =</span> <span class="dv">1</span>,</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">rows =</span> <span class="dv">10</span>,</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">pal =</span> magma,</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">wl =</span> <span class="dv">200</span>,</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">flim =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">10</span>),</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">collevels =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">140</span>, <span class="dv">0</span>, <span class="dv">5</span>),</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"./examples/hermit/"</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="images/fullspec_hermit.gif" alt="hermit" width="80%"></p>
<p>&nbsp;</p>
</section>
<section id="catalogs" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="catalogs"><span class="header-section-number">5.1</span> Catalogs</h2>
<p>Catalogs allow you to inspect selections of many recordings in the same image and group them by categories. This makes it easier to verify the consistency of the categories. Many of the arguments are shared with <code>tweak_spectro()</code> (<code>catalog()</code> is used internally in <code>tweak_spectro()</code>). We can generate a catalog with color tags to identify selections from the same sound file as follows:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read bat inquiry data</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>inq <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">"iniquiry_calls.RDS"</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">catalog</span>(</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> inq[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ],</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">flim =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">50</span>),</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">10</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">10</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">same.time.scale =</span> T,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">mar =</span> <span class="fl">0.01</span>,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">gr =</span> <span class="cn">FALSE</span>,</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">img.suffix =</span> <span class="st">"inquiry"</span>,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"sound.files"</span>, <span class="st">"selec"</span>),</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="dv">0</span>,</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">rm.axes =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">box =</span> F,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.tag =</span> <span class="st">"sound.files"</span>,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">tag.pal =</span> <span class="fu">list</span>(magma),</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">20</span>,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">20</span>,</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">pal =</span> viridis,</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">collevels =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="images/Catalog_p1-inquiry.jpeg" alt="viewSpec" width="100%"></p>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Exercise</font></p>
<p>&nbsp; - Modify the previous code of <code>catalog()</code> to create a catalog with 5 rows and 20 columns, using the ‘wl’ value and color palette that you considered best when using <code>tweak_spectro()</code> with the ‘inq’ data.</p>
<ul>
<li>Using the ‘lbh_selec_table’ data, create a catalog with selections color-tagged by song type</li>
</ul>
</div>
<p>&nbsp;</p>
</section>
<section id="tailoring-selections" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="tailoring-selections"><span class="header-section-number">5.2</span> Tailoring selections</h2>
<p>The position of the selections in the sound file (i.e.&nbsp;its ‘coordinates’ of time and frequency) can be modified interactively from R using the <code>sel_tailor()</code> function. This function produces a graphic window showing spectrograms and a series of ‘buttons’ that allow you to modify the view and move forward in the selection table:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tailor_sels</span>(<span class="at">X =</span> lbh_selec_table[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, ], <span class="at">auto.next =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="images/seltailor.autonext.gif" alt="seltailor autonext" width="100%"></p>
<p>&nbsp;</p>
<p>The function returns the corrected data as a data frame in R and also saves a ‘.csv’ file in the directory where the sound files are located.</p>
<p><code>sel_tailor()</code> can also be used to modify frequency contours such as those produced by the <code>dfDTW()</code> or <code>ffDTW()</code> function:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>cntours <span class="ot">&lt;-</span> <span class="fu">freq_ts</span>(<span class="at">X =</span> lbh_selec_table[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, ])</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>tail.cntours <span class="ot">&lt;-</span> <span class="fu">tailor_sels</span>(<span class="at">X =</span> lbh_selec_table[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, ],</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ts.df =</span> cntours,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">auto.contour =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="images/seltailor.contour.gif" alt="seltailor autonext" width="100%"></p>
<p>&nbsp;</p>
<hr>
</section>
<section id="references" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="references"><span class="header-section-number">5.3</span> References</h2>
<ol type="1">
<li>Araya-Salas M, Smith-Vidaurre G (2017) warbleR: An R package to streamline analysis of animal acoustic signals. Methods Ecol Evol 8:184–191.</li>
</ol>
<p>&nbsp;</p>
<hr>
<!-- add packages used, system details and versions  -->
</section>
</section>
<section id="session-information" class="level1 unnumbered unlisted">
<h1 class="unnumbered unlisted">Session information</h1>
<details>
<summary>
Click to see
</summary>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.3.2 (2023-10-31)
 os       Ubuntu 22.04.2 LTS
 system   x86_64, linux-gnu
 ui       X11
 language es_ES:en
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       America/Costa_Rica
 date     2025-10-09
 pandoc   3.1.11 @ /usr/lib/rstudio/resources/app/bin/quarto/bin/tools/x86_64/ (via rmarkdown)

─ Packages ───────────────────────────────────────────────────────────────────
 package      * version   date (UTC) lib source
 bioacoustics   0.2.8     2022-02-08 [1] CRAN (R 4.3.2)
 bitops         1.0-9     2024-10-03 [1] CRAN (R 4.3.2)
 brio           1.1.5     2024-04-24 [1] CRAN (R 4.3.2)
 cachem         1.1.0     2024-05-16 [1] CRAN (R 4.3.2)
 cli            3.6.5     2025-04-23 [1] CRAN (R 4.3.2)
 curl           7.0.0     2025-08-19 [1] CRAN (R 4.3.2)
 devtools       2.4.5     2022-10-11 [1] CRAN (R 4.3.2)
 digest         0.6.37    2024-08-19 [1] CRAN (R 4.3.2)
 dtw            1.23-1    2022-09-19 [1] CRAN (R 4.3.2)
 ellipsis       0.3.2     2021-04-29 [3] CRAN (R 4.1.1)
 evaluate       1.0.5     2025-08-27 [1] CRAN (R 4.3.2)
 farver         2.1.2     2024-05-13 [1] CRAN (R 4.3.2)
 fastmap        1.2.0     2024-05-15 [1] CRAN (R 4.3.2)
 fftw           1.0-9     2024-09-20 [1] CRAN (R 4.3.2)
 fs             1.6.6     2025-04-12 [1] CRAN (R 4.3.2)
 glue           1.8.0     2024-09-30 [1] CRAN (R 4.3.2)
 htmltools      0.5.8.1   2024-04-04 [1] CRAN (R 4.3.2)
 htmlwidgets    1.6.4     2023-12-06 [1] CRAN (R 4.3.2)
 httpuv         1.6.13    2023-12-06 [1] CRAN (R 4.3.2)
 httr           1.4.7     2023-08-15 [1] CRAN (R 4.3.2)
 jsonlite       2.0.0     2025-03-27 [1] CRAN (R 4.3.2)
 kableExtra   * 1.4.0     2024-01-24 [1] CRAN (R 4.3.2)
 knitr        * 1.50      2025-03-16 [1] CRAN (R 4.3.2)
 later          1.3.2     2023-12-06 [1] CRAN (R 4.3.2)
 lifecycle      1.0.4     2023-11-07 [1] CRAN (R 4.3.2)
 magrittr       2.0.4     2025-09-12 [1] CRAN (R 4.3.2)
 MASS           7.3-55    2022-01-13 [4] CRAN (R 4.1.2)
 memoise        2.0.1     2021-11-26 [3] CRAN (R 4.1.2)
 mime           0.13      2025-03-17 [1] CRAN (R 4.3.2)
 miniUI         0.1.1.1   2018-05-18 [3] CRAN (R 4.0.1)
 moments        0.14.1    2022-05-02 [1] CRAN (R 4.3.2)
 NatureSounds * 1.0.5     2025-01-17 [1] CRAN (R 4.3.2)
 pbapply        1.7-4     2025-07-20 [1] CRAN (R 4.3.2)
 pkgbuild       1.4.8     2025-05-26 [1] CRAN (R 4.3.2)
 pkgload        1.4.0     2024-06-28 [1] CRAN (R 4.3.2)
 profvis        0.3.8     2023-05-02 [1] CRAN (R 4.3.2)
 promises       1.2.1     2023-08-10 [1] CRAN (R 4.3.2)
 proxy          0.4-27    2022-06-09 [1] CRAN (R 4.3.2)
 purrr          1.1.0     2025-07-10 [1] CRAN (R 4.3.2)
 R6             2.6.1     2025-02-15 [1] CRAN (R 4.3.2)
 RColorBrewer   1.1-3     2022-04-03 [1] CRAN (R 4.3.2)
 Rcpp           1.1.0     2025-07-02 [1] CRAN (R 4.3.2)
 RCurl          1.98-1.17 2025-03-22 [1] CRAN (R 4.3.2)
 remotes        2.5.0     2024-03-17 [1] CRAN (R 4.3.2)
 rjson          0.2.23    2024-09-16 [1] CRAN (R 4.3.2)
 rlang          1.1.6     2025-04-11 [1] CRAN (R 4.3.2)
 rmarkdown      2.30      2025-09-28 [1] CRAN (R 4.3.2)
 rstudioapi     0.17.1    2024-10-22 [1] CRAN (R 4.3.2)
 scales         1.4.0     2025-04-24 [1] CRAN (R 4.3.2)
 seewave      * 2.2.3     2023-10-19 [1] CRAN (R 4.3.2)
 sessioninfo    1.2.2     2021-12-06 [1] CRAN (R 4.3.2)
 shiny          1.8.0     2023-11-17 [1] CRAN (R 4.3.2)
 signal         1.8-1     2024-06-26 [1] CRAN (R 4.3.2)
 stringi        1.8.7     2025-03-27 [1] CRAN (R 4.3.2)
 stringr        1.5.2     2025-09-08 [1] CRAN (R 4.3.2)
 svglite        2.2.1     2025-05-12 [1] CRAN (R 4.3.2)
 systemfonts    1.3.1     2025-10-01 [1] CRAN (R 4.3.2)
 testthat       3.2.3     2025-01-13 [1] CRAN (R 4.3.2)
 textshaping    1.0.3     2025-09-02 [1] CRAN (R 4.3.2)
 tuneR        * 1.4.7     2024-04-17 [1] CRAN (R 4.3.2)
 urlchecker     1.0.1     2021-11-30 [1] CRAN (R 4.3.2)
 usethis        3.1.0     2024-11-26 [1] CRAN (R 4.3.2)
 vctrs          0.6.5     2023-12-01 [1] CRAN (R 4.3.2)
 viridisLite    0.4.2     2023-05-02 [1] CRAN (R 4.3.2)
 warbleR      * 1.1.36    2016-04-19 [1] Github (maRce10/warbleR@a938839)
 withr          3.0.2     2024-10-28 [1] CRAN (R 4.3.2)
 xfun           0.53      2025-08-19 [1] CRAN (R 4.3.2)
 xml2           1.4.0     2025-08-20 [1] CRAN (R 4.3.2)
 xtable         1.8-4     2019-04-21 [3] CRAN (R 4.0.1)
 yaml           2.3.10    2024-07-26 [1] CRAN (R 4.3.2)

 [1] /home/marce/R/x86_64-pc-linux-gnu-library/4.3
 [2] /usr/local/lib/R/site-library
 [3] /usr/lib/R/site-library
 [4] /usr/lib/R/library

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>
</details>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/marce10\.github\.io\/PRSTATS_BR_2025\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025 | <a href="https://marce10.github.io">Marcelo Araya-Salas</a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>